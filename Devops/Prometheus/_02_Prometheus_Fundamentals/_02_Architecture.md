# Prometheus Architecture

Prometheus follows a modular architecture for monitoring and managing metric data. Here's an overview of its components and their functionalities:

## Components:

1. **Targets**:
   - **Definition**: Targets are the entities from which Prometheus collects metric data. These targets expose metrics through HTTP endpoints.
   - **Discovery**: Prometheus can dynamically discover targets using service discovery mechanisms.

2. **Exporters**:
   - **Definition**: Exporters are components that enable Prometheus to scrape metrics data from various third-party systems or services that do not natively support Prometheus.
   - **Functionality**: Exporters transform metrics data into a format that Prometheus can understand and scrape.

3. **Prometheus Server**:
   - **Functionality**: 
     - **Scrapes Metric Data**: The Prometheus server scrapes metric data from configured targets and exporters at regular intervals.
     - **Stores Metric Data**: It stores the scraped metric data in a Time Series Database (TSDB).
     - **Accepts PromQL Queries**: It accepts queries in PromQL (Prometheus Query Language) for analyzing and retrieving metric data.
     - **Web UI**: Provides a web-based user interface for visualization and querying of metric data.

4. **Pushgateway**:
   - **Functionality**: 
     - Acts as an intermediary for short-lived jobs or batch processes that cannot be scraped directly by Prometheus.
     - Jobs push metrics to Pushgateway, which Prometheus can then scrape from Pushgateway.

5. **Alertmanager**:
   - **Functionality**: 
     - Manages alerts generated by Prometheus.
     - Allows for defining alerting rules based on metric data.
     - Sends alerts to appropriate channels (e.g., email, Slack) based on defined configurations.

## Data Flow:

1. **Metric Scraping**:
   - Prometheus server periodically scrapes metric data from configured targets and exporters.
   - It retrieves metric data via HTTP requests.

2. **Storage**:
   - Scraped metric data is stored in a Time Series Database (TSDB) for analysis and querying.

3. **Querying**:
   - Users can query the stored metric data using PromQL via the Prometheus server's web UI or API.

4. **Alerting**:
   - Prometheus evaluates defined alerting rules based on metric data.
   - Alertmanager manages alerts, sends notifications, and handles alert lifecycle.

Prometheus architecture facilitates the collection, storage, querying, visualization, and alerting of metric data, enabling effective monitoring and management of systems and applications.

# Collecting Metrics in Prometheus

## HTTP Endpoint Scraping
- Prometheus collects metrics by sending HTTP requests to the `/metrics` endpoint of each target.
- Configuration allows using a different path instead of `/metrics`.

## Exporters
- **Definition**: Exporters are used to collect metrics from systems that don't natively expose them in a Prometheus-compatible format.
- **Functionality**: Exporters gather metrics and expose them in a format expected by Prometheus.
- **Types**:
  - **Native Exporters**: Included with Prometheus.
    - Node Exporter (for Linux servers)
    - Windows Exporter
    - MySQL Exporter
    - Apache Exporter
    - HAProxy Exporter
  - **Custom Exporters**: Developed for specific systems or applications.

## Client Libraries
- **Definition**: Client libraries enable monitoring of application-specific metrics.
- **Functionality**: They allow applications to expose custom metrics for Prometheus to track.
- **Metrics Examples**:
  - Number of errors/exceptions
  - Latency of requests
  - Job execution time
- **Language Support**:
  - Go
  - Java
  - Python
  - Ruby
  - Rust

## Monitoring Application Metrics
- Prometheus client libraries facilitate the exposure of application metrics, enabling monitoring of specific metrics relevant to the application's performance and behavior.
- Exporters and client libraries together extend Prometheus's capability to collect and analyze a wide range of metrics from various systems and applications.
